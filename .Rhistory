theme_bw()
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param,
shape = H0)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_wrap(~ n.tau,
scales = "free",
labeller = labeller(
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
theme_bw() +
theme(legend.position = "bottom")
## parameter labels
param.labs <- c(
"p1" = expression(theta["edges"]^"+"),
"p2" = expression(theta[Z]^"+"),
"p3" = expression(theta[Y]^"+"),
"p4" = expression(theta[ZY]^"+"),
"m1" = expression(theta["edges"]^"-"),
"m2" = expression(theta[Z]^"-"),
"m3" = expression(theta[Y]^"-"),
"m4" = expression(theta[ZY]^"-")
## summarize sterm param results
theta.summary <- theta.res %>%
## parameter labels
param.labs <- c(
"p1" = expression(theta["edges"]^"+"),
"p2" = expression(theta[Z]^"+"),
"p3" = expression(theta[Y]^"+"),
"p4" = expression(theta[ZY]^"+"),
"m1" = expression(theta["edges"]^"-"),
"m2" = expression(theta[Z]^"-"),
"m3" = expression(theta[Y]^"-"),
"m4" = expression(theta[ZY]^"-"))
## summarize sterm param results
theta.summary <- theta.res %>%
mutate(param = factor(
param,
levels = c(paste0("p", 1:4), paste0("m", 1:4)))) %>%
group_by(H0, n.tau, param) %>%
summarise(bias = mean(est - true),
ESE = sd(est),
ASE = mean(sd),
.groups = "drop")
## plot STERGM parameter estimates
ggplot(theta.res,
aes(x = param,
y = est - true)) +
geom_boxplot(outlier.size = 0.5,
alpha = 0.6) +
stat_summary(
fun = mean,
geom = "point",
shape = 21,
size = 2,
fill = "white",
color = "black") +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Parameter",
y = "Empirical Bias",
title = "Empirical Distribution of STERGM Parameters") +
geom_hline(yintercept = 0,
color = "blue",
linetype = "dashed") +
scale_x_discrete(
labels = param.labs)) +
## plot STERGM parameter estimates
ggplot(theta.res,
aes(x = param,
y = est - true)) +
geom_boxplot(outlier.size = 0.5,
alpha = 0.6) +
stat_summary(
fun = mean,
geom = "point",
shape = 21,
size = 2,
fill = "white",
color = "black") +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Parameter",
y = "Empirical Bias",
title = "Empirical Distribution of STERGM Parameters") +
geom_hline(yintercept = 0,
color = "blue",
linetype = "dashed") +
scale_x_discrete(
labels = param.labs) +
theme_bw()
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_wrap(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_y") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
x
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
x = "Empirical SE (ESE)",
y = "Average SE (ASE)",
title = "ASE vs ESE") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
x = "Empirical SE (ESE)",
y = "Average Estimated SE (ASE)",
title = "Average Estimated Standard Errors vs Empirical standard Errors") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
#title = "Average Estimated Standard Errors vs Empirical standard Errors",
x = "Empirical SE (ESE)",
y = "Average Estimated SE (ASE)") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## plot STERGM parameter estimates
ggplot(theta.res,
aes(x = param,
y = est - true)) +
geom_boxplot(outlier.size = 0.5,
alpha = 0.6) +
stat_summary(
fun = mean,
geom = "point",
shape = 21,
size = 2,
fill = "white",
color = "black") +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
#title = "Empirical Distribution of STERGM Parameter Estimators"
x = "Parameter",
y = "Empirical Bias") +
geom_hline(yintercept = 0,
color = "blue",
linetype = "dashed") +
scale_x_discrete(
labels = param.labs) +
theme_bw()
## save image
ggsave("simulation/sim_figures/sim3/sim3_thetadistr.png",
dpi = 300, width = 6, height = 6)
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
#title = "Average Estimated Standard Errors vs Empirical standard Errors",
x = "Empirical SE (ESE)",
y = "Average Estimated SE (ASE)") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## save image
ggsave("simulation/sim_figures/sim3/sim3_thetaase.png",
dpi = 300, width = 6, height = 4)
## parameter labels
param.labs <- c(
"p1" = expression(theta["edges"]^"+"),
"p2" = expression(theta[Z]^"+"),
"p3" = expression(theta[Y]^"+"),
"p4" = expression(theta[ZY]^"+"),
"m1" = expression(theta["edges"]^"-"),
"m2" = expression(theta[Z]^"-"),
"m3" = expression(theta[Y]^"-"),
"m4" = expression(theta[ZY]^"-"))
## summarize sterm param results
theta.summary <- theta.res %>%
mutate(param = factor(
param,
levels = c(paste0("p", 1:4), paste0("m", 1:4)))) %>%
group_by(H0, n.tau, param) %>%
summarise(bias = mean(est - true),
ESE = sd(est),
ASE = mean(sd),
.groups = "drop")
## plot STERGM parameter estimates
ggplot(theta.res,
aes(x = param,
y = est - true)) +
geom_boxplot(outlier.size = 0.5,
alpha = 0.6) +
stat_summary(
fun = mean,
geom = "point",
shape = 21,
size = 2,
fill = "white",
color = "black") +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed))) +
labs(
#title = "Empirical Distribution of STERGM Parameter Estimators"
x = "Parameter",
y = "Empirical Bias") +
geom_hline(yintercept = 0,
color = "blue",
linetype = "dashed") +
scale_x_discrete(
labels = param.labs) +
theme_bw()
## save image
ggsave("simulation/sim_figures/sim3/sim3_thetadistr.png",
dpi = 300, width = 6, height = 6)
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
#title = "Average Estimated Standard Errors vs Empirical standard Errors",
x = "Empirical SE (ESE)",
y = "Average Estimated SE (ASE)") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## save image
ggsave("simulation/sim_figures/sim3/sim3_thetaase.png",
dpi = 300, width = 6, height = 4)
## plot ASE vs ESE
ggplot(theta.summary,
aes(x = ESE,
y = ASE,
color = param)) +
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
geom_point(size = 3) +
facet_grid(H0 ~ n.tau,
labeller = labeller(
H0 = as_labeller(H0_labels, label_parsed),
n.tau = as_labeller(n.tau_labels, label_parsed)),
scales = "free_x") +
labs(
#title = "Average Estimated Standard Errors vs Empirical standard Errors",
x = "Empirical SE (ESE)",
y = "Average Estimated SE (ASE)") +
scale_color_manual(
values = RColorBrewer::brewer.pal(8, "Set1"),  # or choose your own colors
labels = param.labs,
name = "Parameter") +
theme_bw() +
theme(legend.position = "bottom")
## save image
ggsave("simulation/sim_figures/sim3/sim3_thetaase.png",
dpi = 300, width = 6, height = 6)
